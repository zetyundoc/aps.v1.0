# 案例分析
### 某运营商集团日志大数据分析平台开发项目
为客户创建基于SCA用户访问日志的大数据安全分析系统，随着智能手机的普及，手机恶意软件日益泛滥。手机恶意软件会造成用户隐私泄露、信息丢失、设备损坏、话费损失等诸多问题，给客户利益带来极大危害，也给移动网络运营带来了不利影响。

数据主要来源于上网日志留存系统日志网关汇聚的各省的用户上网数据，包含分组域通用数据、分组域PDP日志、分组域DNS日志、分组域MMS日志、分组域FTP日志、分组域Email日志、分组域HTTP日志、分组域VOIP日志、分组域RTSP日志、分组域及时通信日志、分组域P2P日志等。

通过疑似行为筛选规则发现所监测网络内的疑似恶意行为，并对应用、机型、地域、用户等分布进行分析画像，及时发现和处置恶意软件的爆发。有效控制手机恶意软件在移动通信网络内的传播。

系统实现了2/3/4G流量的全部覆盖，数据源来自上网日志留存系统日志上报网关。日志访问峰值（含所有协议）2G/3G为105万条/s，4G为4397万条/s，总量为4502万条/s。其中HTTP流量占比约为70，即 3152万条/s。

### 某保险行业大数据分析平台开发项目
**项目背景**

随着某保险公司的业务的快速发展，数据规模的快速膨胀，各业务部门、各分公司对数据的需求越来越迫切，业务人员希望通过更灵活的方式，及时的得到业务分析数据，以便准确、详尽的了解业务状况，对经营决策提供支撑。同时，公司对于监管报送的时效性要求也进一步提高。所以，迫切的希望对原有系统的技术架构进行彻底的升级。

**大数据平台优势**
* **计算加速**
 
  DataCanvas大数据平台，提供了统一的HDFS分布式文件系统，统一的SQL入口，以及包含Hive、HBase、Spark、MPP等技术的多计算引擎融合架构。极大的加速了数据处理的性能。以涉及监管保送的准备金任务为例，原有准备金系统的技术架构为Oracle extradata，随着数据量的不断增加，系统负载的上升，处理性能已经无法满足对于监管报送的时效性要求。其中明细分摊作为其中一个重要的数据处理环节，时间超过六小时。经过迁移到大数据平台后，处理时间只需要200s-300s。对于原有的财产统计分析系统，性能上也有了显著的提升。大多数的业务改造迁移后，都获得了数十倍到数百倍的性能提升。
* **横向扩展**

  DataCanvas平台本身具备的良好的横向可扩展性，在性能或容量无法支撑业务增长时，可以方便的通过增加服务器的方式获得提升。支持的扩展上限达到千台以上，足以满足今后客户对于不断增长的业务数据的处理需求
* **建设和使用成本**

 DataCanvas大数据平台具备统一的SQL入口，兼容ANSI-SQL国际标准，将底层繁琐复杂的任务处理完全透明化。所以对使用Oracle进行开发的技术人员来说，使用上并不存在入门学习门槛。开发人员日常的使用流程，依然是使用数据库客户端（传统客户端即可：如navicat、psql等）连接大数据平台，然后编写查询和存储过程，在客户端上直接执行。
* **异构数据处理**

 异构数据处理，将结构化数据、半结构化数据、非结构化数据（图片、视频等）进行聚合分析，为数据处理和分析方向提供了更多可能性。
 
* **实时处理**

 使用了基于Flume，Spark Streaming， Kafka等核心组件的流式处理方案，更好的满足了时效性要求高的自核业务、告警业务的场景需求。
* **机器学习与数据分析**

 * 实时交互的可视化数据探索工具，帮助数据分析人员发现数据的内在规律。
 * 分布式数据分析、机器学习算法的构建和封装，充分挖掘数据的潜在价值。

* **学习应用门槛**

 使用上唯一的不同之处，是某些语法细节。以Oracle举例来说：
Sysdate

```
set now [database_to_tcl_string $db "select sysdate from dual"]
```
变为

```
set now [database_to_tcl_string $db "select [db_sysdate] from dual"]
```
Decode

```
decode(expr, search, result [, search, result...] [, default])
```
变为

```
CASE WHEN expr THEN expr [...] ELSE expr END
```
Subquery in FROM

```
SELECT * FROM (SELECT * FROM table_a)
```
变为

```
 SELECT * FROM (SELECT * FROM table_a) as foo
```
Outer Joins

```
select a.field1, b.field2
from a, b
where a.item_id = b.item_id(+)

```
变为


```
select a.field1, b.field2
from a
left outer join b
on a.item_id = b.item_id;

```

除此之外，九成以上的通用语法是完全一致的。
根据客户的实际情况，将平台建设分为了如下几个建设阶段：

* **部分业务平行迁移阶段**

 解决处理性能问题。搭建中小规模大数据集群，保留原有技术架构Exadata，梳理目前业务流程，优先选择在原有架构上出现性能瓶颈的分析型业务，迁移到大数据平台之上。发挥大数据平台的处理性能优势，保证业务的按时有效运行。同时对于新的分析型业务，基于大数据平台进行开发。
* **业务整体迁移阶段**

 随着第一阶段的完成，对大数据基础知识和平台的使用熟练度，都会明显提升。在这一阶段，可以将原有业务进一步梳理优化，更完整的迁移到大数据平台之上。

 同时开始尝试使用大数据平台的新功能和新特性，解决一些原有架构无法解决的业务问题。如：复杂数据分析、机器学习建模、实时流数据处理、异构数据处理等
* **分析场景挖掘阶段**

 在这个阶段，能够最大化的发挥大数据平台的优势：
 * 实时交互的可视化数据探索，发现数据的内在规律。
 * 分布式数据分析、机器学习算法的构建和封装，充分挖掘数据的潜在价值。
 * 异构数据处理，将结构化数据、半结构化数据、非结构化数据（图片、视频等）进行聚合分析，为数据处理和分析方向提供更多可能性。
 * 实时流处理技术，更好的处理对时效性要求高的场景。

### 某银行大数据历史库开发项目
传统数据库对海量数据的操作（数据加工、查询等）耗时长，优化改动大、见效慢，存储成本高，逐渐不能满足行业的需要。

日渐成熟的大数据技术不仅具备传统数据库所欠缺的性能优势，并且为银行打开了一扇精确营销的大门，银行利用大数据的优势，可以在市场细分、客户服务、客户研究、产品研发、产品测试等等方面取得重大进步，并在某种程度上彻底改变银行服务客户、销售产品的方式和渠道。

为了实现提高数据利用率，降低数据存储成本，以及现有业务向大数据平台的平稳过渡等，本次大数据历史库开发项目达成了如下建设目标：

**运维管理：**

* 大数据集群具备良好的运维管理性、可扩展性以及容错性
* 对于日志进行针对性的采集和管理
* 通过日志管理查询和搜索能够方便快捷准确的进行错误定位
* 提供了有效的分析工具对错误日志进行分析

**系统功能：**

* 全面、稳定、可靠
* 良好的访问并发性和时效性表现，满足不同场景下的响应需求
* 对海量数据的数据挖掘分析能力
* 对于流数据的实时处理能力
* 平台接口丰富完整
* 二次开发方便快捷

**业务支撑：**

* 对现有行内精准营销等业务实现了有力的支撑
* 极大的提升了数据增、删、改、查等操作和运算效率
* 具备强大的统计分析能力，满足对于未来业务和场景的分析需求

**安全管理：**

* 对于用户的方便管理
* 对于权限的有效控制
* 数据安全可靠性
* 满足行内的安全管理相关规范









